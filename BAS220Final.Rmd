---
title: "BAS 220 Final"
author: "Victoria Kincaid"
date: "5/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r Set Up, include=FALSE}

getwd()
setwd("C:/Users/18033/Desktop/School Schtuff/Current Semester/Spring 2021/BAS 220/Uber")

library(tidyverse)
library(readr)
library(ggplot2)
library(ggthemes)
library(dplyr)
library(lubridate)
library(tidyr)
library(DT)
library(scales)

colors = c("#CC1011", "#665555", "#05a399", "#cfcaca", "#f5e840", "#0683c9", "#e075b0")

apr_data <- read.csv("uber-raw-data-apr14.csv")
may_data <- read.csv("uber-raw-data-may14.csv")
jun_data <- read.csv("uber-raw-data-jun14.csv")
jul_data <- read.csv("uber-raw-data-jul14.csv")
aug_data <- read.csv("uber-raw-data-aug14.csv")
sep_data <- read.csv("uber-raw-data-sep14.csv")

data_2014 <- rbind(apr_data,may_data, jun_data, jul_data, aug_data, sep_data)
           
data_2014$Date.Time <- as.POSIXct(data_2014$Date.Time, format = "%m/%d/%Y %H:%M")

data_2014$Time <- format(as.POSIXct(data_2014$Date.Time, format = "%m/%d/%Y %H:%M"), format = "%H:%M:%S")

data_2014$Date.Time <- ymd_hms(data_2014$Date.Time)

data_2014$day <- factor(day(data_2014$Date.Time))
data_2014$month <- factor(month(data_2014$Date.Time, label = TRUE))
data_2014$year <- factor(year(data_2014$Date.Time))
data_2014$dayofweek <- factor(wday(data_2014$Date.Time, label = TRUE))

data_2014$hour <- factor(hour(hms(data_2014$Time)))
data_2014$minute <- factor(minute(hms(data_2014$Time)))
data_2014$second <- factor(second(hms(data_2014$Time)))
```

**Question 1:	Which month has the most Uber business? How could Uber drivers use 
this information?**
```{r Question 1, echo=FALSE, message=FALSE, warning=FALSE}
month_group <- data_2014 %>%
          group_by(month) %>%
             dplyr::summarize(Total = n()) 
datatable(month_group)

day_month_group <- data_2014 %>%
  group_by(month, day) %>%
  dplyr::summarize(Total = n())

ggplot(day_month_group, aes(month, Total, fill = month)) + 
  geom_bar( stat = "identity") +
  ggtitle("Trips by Month") +
  theme(legend.position = "none") +
  scale_y_continuous(labels = comma) +
  scale_fill_manual(values = colors)

```

*September has the most business, drivers could use this information to know 
when their busy season is, make sure their cars are in good repair before it 
hits (i.e., oil change, new tires)*



**Question 2: Which day of the week has the most Uber business? How could a 
taxicab company use this information?**
```{r Question 2, echo=FALSE, message=FALSE, warning=FALSE}


day_month_group <- data_2014 %>%
  group_by(month, day) %>%
  dplyr::summarize(Total = n())

month_weekday <- data_2014 %>%
  group_by(month, dayofweek) %>%
  dplyr::summarize(Total = n())

ggplot(month_weekday, aes(month, Total, fill = dayofweek)) + 
  geom_bar( stat = "identity", position = "dodge") +
  ggtitle("Trips by Day and Month") +
  scale_y_continuous(labels = comma) +
  scale_fill_manual(values = colors)

ggplot(month_weekday, aes(dayofweek, month, fill = Total)) +
  geom_tile(color = "white") +
  ggtitle("Heat Map by Month and Day of Week")
```

*Looking across the heat map you can see that it is pretty spread out, the
busiest day of each week varies throughout the months, although consistently 
Thursday and Friday seem to bring in more business for Uber drivers. A Taxicab 
company that is a competitor to Uber might offer lower rates on those days 
(Thursday special) to try to take business away from Uber.*



**Question 3: Which hour of the day has the most Uber business? How could 
consumers use this information?**
```{r Question 3, echo=FALSE, message=FALSE, warning=FALSE}
hour_data <- data_2014 %>%
  group_by(hour) %>%
  dplyr::summarize(Total = n()) 
datatable(hour_data)

ggplot(hour_data, aes(hour, Total)) + 
  geom_bar( stat = "identity", fill = "steelblue", color = "red") +
  ggtitle("Trips Every Hour") +
  theme(legend.position = "none") +
  scale_y_continuous(labels = comma)

month_hour <- data_2014 %>%
  group_by(month, hour) %>%
  dplyr::summarize(Total = n())

ggplot(month_hour, aes(hour, Total, fill = month)) + 
  geom_bar( stat = "identity") +
  ggtitle("Trips by Hour and Month") +
  scale_y_continuous(labels = comma)

day_and_hour <- data_2014 %>%
  group_by(day, hour) %>%
  dplyr::summarize(Total = n())

ggplot(day_and_hour, aes(day, hour, fill = Total)) +
            geom_tile(color = "white") +
              ggtitle("Heat Map by Hour and Day")
```

*5PM is consistently the busiest hour of the day for Uber business. Consumers 
might take this information into note that they should do any activities 
earlier in the day (like grocery shopping) while the rates are still low. And,
if you’re out and about in the afternoon waiting it out won’t help too much,
the rate doesn’t really drop until 11PM.*



**Question 4: If you were to enter your personal latitude and longitude 
information (GPS coordinates) in the geo-plot code, what outcome would you 
expect and why?**

```{r Question 4, echo=FALSE, message=FALSE, warning=FALSE}
min_lat <- 40.5774
max_lat <- 40.9176
min_long <- -74.15
max_long <- -73.7004

ggplot(data_2014, aes(x = Lon, y = Lat)) +
  geom_point(size = 1, color = "blue") +
  scale_x_continuous(limits = c(min_long, max_long)) +
  scale_y_continuous(limits = c(min_lat, max_lat)) +
  theme_map() +
  ggtitle("NYC MAP BASED ON UBER RIDES DURING 2014 (APR-SEP)")
```

*Since my current coordinates are no where near New York City, I believe that it
would pull up an error message, or NA due to the fact that I am outside the
specified range of minimum latitude*



**Question 5:	Which parts of the exercise did you struggle with most? Which
 parts did you find easy?**


*First of all, the main issue I had and struggled with the most was the 
beginning of this project. One of the .csv files didn't have Date.Time as a
column header, so when they didn't conform together for data_2014 it through
me off, there were also small minor adjustments like color initially had two 
extra "" which changed it from code to a statement. The biggest contender was 
the lubridate, time issue I had. I spent some time learning the different date
functions to see where my issues were. Here is a list of websites besides our
textbooks that helped me find the answers to fix this:*

https://stackoverflow.com/questions/62140483/how-to-interpret-dplyr-message-summarise-regrouping-output-by-x-override

https://stackoverflow.com/questions/57798148/warning-some-strings-failed-to-parse-or-all-strings-are-nas

https://www.neonscience.org/resources/learning-hub/tutorials/dc-convert-date-time-posix-r

https://blog.rsquaredacademy.com/handling-date-and-time-in-r/

https://community.rstudio.com/t/convert-date-character-to-posixct/80360

*I took screenshots of the data and can send them later if relevant, but it
boiled down to proper formatting.*

*Now, the easy part was everything else, once I figured out the initial puzzle
of the Date problem I was able to get the graphs running with no issue. Adding
to that here are the remaining tables and graphs for the Final. I just pulled 
the ones up front that were relevant for the questions.*

```{r Question 5, echo=FALSE, message=FALSE, warning=FALSE}
day_group <- data_2014 %>%
          group_by(day) %>%
             dplyr::summarize(Total = n()) 
datatable(day_group)

ggplot(day_group, aes(day, Total)) + 
        geom_bar( stat = "identity", fill = "steelblue") +
           ggtitle("Trips Every Day") +
            theme(legend.position = "none") +
            scale_y_continuous(labels = comma)

day_and_hour <- data_2014 %>%
         group_by(day, hour) %>%
            dplyr::summarize(Total = n())

datatable(day_and_hour)

ggplot(day_month_group, aes(day, month, fill = Total)) +
            geom_tile(color = "white") +
              ggtitle("Heat Map by Month and Day")

day_month_group <- data_2014 %>%
         group_by(month, day) %>%
             dplyr::summarize(Total = n())

ggplot(day_month_group, aes(day, Total, fill = month)) + 
        geom_bar( stat = "identity") +
           ggtitle("Trips by Day and Month") +
            scale_y_continuous(labels = comma) +
            scale_fill_manual(values = colors)

```